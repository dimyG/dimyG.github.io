<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property="og:description" content="" /><title>Django Random Tips | Dimitris Georgoulas</title><meta name="generator" content="Jekyll v4.0.1" /><meta property="og:title" content="Django Random Tips" /><meta name="author" content="Dimitris Georgoulas" /><meta property="og:locale" content="en_US" /><meta name="description" content="Avoiding race conditions in django Use an F() expression when updating a model field’s value relatively to its previous value. For example: 1 2 3 4 5 from django.db.models import F product = Product.objects.get(name=&#39;Numenor stone&#39;) # don&#39;t do this: product.number_sold += 1 product.save() We want to avoid loading the number_sold value in memory, doing the calculation (in this case adding 1) and then saving back to the database, because while the value is in memory, the actual value in the database might be modified by another application instance. This would mean that the first application instance will use an outdated value for the calculation. 1 2 3 # do this instead product.number_sold = F(&#39;number_sold&#39;) + 1 product.save() The F() object generates an SQL expression that describes the required operation at the database level, so you avoid loading the value in memory. When product.save() is executed the operation will use the database’s value." /><meta property="og:description" content="Avoiding race conditions in django Use an F() expression when updating a model field’s value relatively to its previous value. For example: 1 2 3 4 5 from django.db.models import F product = Product.objects.get(name=&#39;Numenor stone&#39;) # don&#39;t do this: product.number_sold += 1 product.save() We want to avoid loading the number_sold value in memory, doing the calculation (in this case adding 1) and then saving back to the database, because while the value is in memory, the actual value in the database might be modified by another application instance. This would mean that the first application instance will use an outdated value for the calculation. 1 2 3 # do this instead product.number_sold = F(&#39;number_sold&#39;) + 1 product.save() The F() object generates an SQL expression that describes the required operation at the database level, so you avoid loading the value in memory. When product.save() is executed the operation will use the database’s value." /><link rel="canonical" href="https://dimyg.github.io/posts/django-tips/" /><meta property="og:url" content="https://dimyg.github.io/posts/django-tips/" /><meta property="og:site_name" content="Dimitris Georgoulas" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-04T00:30:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Django Random Tips" /><meta name="twitter:site" content="@DimiGeorgoulas" /><meta name="twitter:creator" content="@Dimitris Georgoulas" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"Django Random Tips","url":"https://dimyg.github.io/posts/django-tips/","dateModified":"2020-05-04T00:30:00+00:00","datePublished":"2020-05-04T00:30:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dimyg.github.io/posts/django-tips/"},"author":{"@type":"Person","name":"Dimitris Georgoulas"},"description":"Avoiding race conditions in django Use an F() expression when updating a model field’s value relatively to its previous value. For example: 1 2 3 4 5 from django.db.models import F product = Product.objects.get(name=&#39;Numenor stone&#39;) # don&#39;t do this: product.number_sold += 1 product.save() We want to avoid loading the number_sold value in memory, doing the calculation (in this case adding 1) and then saving back to the database, because while the value is in memory, the actual value in the database might be modified by another application instance. This would mean that the first application instance will use an outdated value for the calculation. 1 2 3 # do this instead product.number_sold = F(&#39;number_sold&#39;) + 1 product.save() The F() object generates an SQL expression that describes the required operation at the database level, so you avoid loading the value in memory. When product.save() is executed the operation will use the database’s value.","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/olympus_rec_3.jpg" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">Dimitris Georgoulas</a></div><div id="site-subtitle" class="font-italic">Full stack web developer, Mechanical engineer, Father, Husband, Passionate about learning, Excited with technology, Located in Thessaloniki, Greece</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border" style="color: green"></span> <a href="https://github.com/dimyG" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://stackoverflow.com/users/2369865/dimyg" target="_blank"> <i class="fab fa-stack-overflow"></i> </a> <a href="https://twitter.com/DimiGeorgoulas" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="javascript:window.open('mailto:' + ['dimgeows','gmail.com'].join('@'))"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Django Random Tips</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Django Random Tips</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Mon, May 4, 2020, 12:30 AM +0000"> May 4, 2020 <i class="unloaded">2020-05-04T00:30:00+00:00</i> </span> by <span class="author"> Dimitris Georgoulas </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 5, 2020, 1:19 PM +0300"> Aug 5, 2020 <i class="unloaded">2020-08-05T10:19:52+00:00</i> </span></div></div><div class="post-content"><h2 id="avoiding-race-conditions-in-django">Avoiding race conditions in django</h2><ul><li>Use an <code class="highlighter-rouge">F() expression</code> when updating a model field’s value relatively to its previous value. For example:<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">F</span>
<span class="n">product</span> <span class="o">=</span> <span class="n">Product</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Numenor stone'</span><span class="p">)</span>
<span class="c1"># don't do this:
</span><span class="n">product</span><span class="p">.</span><span class="n">number_sold</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">product</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></table></code></div></div><p>We want to avoid loading the <em>number_sold</em> value in memory, doing the calculation (in this case adding 1) and then saving back to the database, because while the value is in memory, the actual value in the database might be modified by another application instance. This would mean that the first application instance will use an outdated value for the calculation.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># do this instead
</span><span class="n">product</span><span class="p">.</span><span class="n">number_sold</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="s">'number_sold'</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">product</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></table></code></div></div><p>The F() object generates an SQL expression that describes the required operation at the database level, so you avoid loading the value in memory. When product.save() is executed the operation will use the database’s value.</p></li><li>If we use <code class="highlighter-rouge">get_or_create()</code> or <code class="highlighter-rouge">update_or_create()</code> methods, we must enforce <strong>uniqueness</strong> in database level for the given keyword arguments. This is a get_or_create() example but the reasoning is identical for update_or_create() too.<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">highlander</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Immortal</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get_or_create</span><span class="p">(</span>
  <span class="n">first_name</span><span class="o">=</span><span class="s">'Connor'</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s">'MacLeod'</span>
<span class="p">)</span>
<span class="c1"># get_or_create is equivalent to the following:
</span><span class="k">try</span><span class="p">:</span>
  <span class="n">highlander</span> <span class="o">=</span> <span class="n">Immortal</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s">'Connor'</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s">'MacLeod'</span><span class="p">)</span>
<span class="k">except</span> <span class="n">Immortal</span><span class="p">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
  <span class="n">highlander</span> <span class="o">=</span> <span class="n">Immortal</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s">'Connor'</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s">'MacLeod'</span><span class="p">)</span>
  <span class="n">highlander</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></table></code></div></div><p>If highlander does not exist and two different application instances run this code at the same time then they will both try to create him. If there is nothing to ensure that there can be only one highlander we can end up with two. To avoid this we must enforce uniqueness at the database level.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Immortal</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">Charfield</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
  <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">Charfield</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

  <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
      <span class="c1"># enforce uniqueness to avoid duplicate entries
</span>      <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">'first_name'</span><span class="p">,</span> <span class="s">'last_name'</span><span class="p">)</span>
</pre></table></code></div></div><p>Now only the faster application instance will actually create the highlander. The second one will just raise an IntegrityError.</p></li><li>If you want to update an existing model instance, use the <code class="highlighter-rouge">update()</code> method instead of loading it in memory and then calling save() on it, in order to avoid the possibility that the entry is modified (for example deleted) in the short period of time between loading and saving. The update() method creates a raw SQL expression to update the model directly in the database.<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># instead of doing this:
</span><span class="n">captain</span> <span class="o">=</span> <span class="n">Person</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">captain</span><span class="p">.</span><span class="n">last_name</span> <span class="o">=</span> <span class="s">'Adama'</span>
<span class="n">captain</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
<span class="c1"># do this:
</span><span class="n">Person</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">update</span><span class="p">(</span><span class="n">last_name</span><span class="o">=</span><span class="s">'Adama'</span><span class="p">)</span>
</pre></table></code></div></div><blockquote><p><strong><em>Note</em></strong>: The update() method does an update at the SQL level and thus, does not call any save() methods on your models. This means that the pre_save() and post_save() signals which are a consequence of calling Model.save() are also not called. If executing the model’s save() method or its related signals is necessary then you can’t use update(). In this case you have to use the select_for_update() queryset method in combination with database transactions. See below.</p></blockquote></li><li>Using the <code class="highlighter-rouge">select_for_update()</code> queryset method in combination with <strong>database transactions</strong>.<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">transaction</span>
<span class="n">wandering_hobbits</span> <span class="o">=</span> <span class="n">Hobbit</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">select_for_update</span><span class="p">().</span><span class="nb">filter</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="s">'Bree'</span><span class="p">)</span>
<span class="k">with</span> <span class="n">transaction</span><span class="p">.</span><span class="n">atomic</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">hobbit</span> <span class="ow">in</span> <span class="n">wandering_hobbits</span><span class="p">:</span>
      <span class="n">hobbit</span><span class="p">.</span><span class="n">location</span> <span class="o">=</span> <span class="s">'Lothlorien'</span>
      <span class="n">hobbit</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></table></code></div></div><p>When the queryset is evaluated (for hobbit in wandering_hobbits in this case), all matched hobbits will be locked until the end of the transaction block, meaning that other transactions will be prevented from changing or acquiring locks on them.</p><blockquote><p><strong><em>Note</em></strong>: The select_for_update() method locks rows by using a <em>SELECT … FOR UPDATE</em> SQL statement on supported databases. This is not a table level lock, it is a row level lock, so the rest of table’s rows can be normally accessed by other application instances which means that the overall performance of your service is not reduced.</p></blockquote></li><li>And a small bonus. A post describing the cumbersome process of <a href="https://medium.com/in-the-weeds/fixing-a-race-condition-c8b475fbb994">Fixing a race condition</a>. It does it in a ruby on rails context but the fundamentals are identical.</li></ul><h2 id="select_related-and-prefetch_related">select_related() and prefetch_related()</h2><p>select_related() and prefetch_related() can greatly improve the performance of your code. They return a QuerySet that will automatically retrieve, in a single batch, related objects for each of the specified lookups. This would become more clear with an example where data relationships span across many models and if select_related() and prefetch_related() were not used, the impact on performance would be unbearable.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">TotalBet</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">'total_bets'</span><span class="p">)</span>
    <span class="n">bets</span> <span class="o">=</span> <span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Bet</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Bet</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">bet_events</span> <span class="o">=</span> <span class="n">ManyToManyField</span><span class="p">(</span><span class="n">BetEvent</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">BetEvent</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Event</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">'bet_events'</span><span class="p">)</span>
    <span class="n">market_type</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">MarketType</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">'bet_events'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">home_team</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Team</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">'events'</span><span class="p">)</span>

<span class="n">total_bets</span> <span class="o">=</span> <span class="n">TotalBet</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">won</span><span class="p">)</span>

<span class="k">for</span> <span class="n">total_bet</span> <span class="ow">in</span> <span class="n">total_bets</span><span class="p">:</span>  <span class="c1"># database hit
</span>    <span class="n">user</span> <span class="o">=</span> <span class="n">total_bet</span><span class="p">.</span><span class="n">user</span>  <span class="c1"># database hit
</span>    <span class="k">for</span> <span class="n">bet</span> <span class="ow">in</span> <span class="n">total_bet</span><span class="p">.</span><span class="n">bets</span><span class="p">.</span><span class="nb">all</span><span class="p">():</span>  <span class="c1"># database hit
</span>        <span class="k">for</span> <span class="n">bet_event</span> <span class="ow">in</span> <span class="n">bet</span><span class="p">.</span><span class="n">bet_events</span><span class="p">.</span><span class="nb">all</span><span class="p">():</span>  <span class="c1"># database hit
</span>            <span class="n">market_type</span> <span class="o">=</span> <span class="n">bet_event</span><span class="p">.</span><span class="n">market_type</span>  <span class="c1"># database hit 
</span>            <span class="n">home_team</span> <span class="o">=</span> <span class="n">bet_event</span><span class="p">.</span><span class="n">event</span><span class="p">.</span><span class="n">home_team</span>  <span class="c1"># database hit
</span></pre></table></code></div></div><p>You can significantly improve performance by fetching all necessary data at once, in a single batch, using select_related() and prefetch_related() and then loop through them</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">total_bets</span> <span class="o">=</span> <span class="n">TotalBet</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">won</span><span class="p">).</span><span class="n">select_related</span><span class="p">(</span><span class="s">'user'</span><span class="p">).</span>\
        <span class="n">prefetch_related</span><span class="p">(</span><span class="s">'bets__bet_events'</span><span class="p">,</span> <span class="s">'bets__bet_events__market_type'</span><span class="p">,</span>
                          <span class="s">'bets__bet_events__event__home_team'</span><span class="p">,</span> 
                          <span class="s">'bets__bet_events__event__away_team'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">total_bet</span> <span class="ow">in</span> <span class="n">total_bets</span><span class="p">:</span>
    <span class="p">...</span>
</pre></table></code></div></div><p>The related data is stored in prefetched querysets, so instead of hitting the database for expensive joins many times during the for loop, we hit it only once, performing some super expensive queries but in one batch greatly improving the performance.</p><blockquote><p><strong><em>Note</em></strong>: The difference between select_related and prefetch_related lies in how they work under the hood. The result is, that select_related() is limited to single-valued relationships (foreign key and one-to-one) while prefetch_related() on the other hand, can prefetch many-to-many and many-to-one objects.</p></blockquote><h2 id="django-forms-validation-in-a-nutshell">Django forms validation in a nutshell</h2><p>Form validation is normally executed when you call the <code class="highlighter-rouge">Form.is_valid()</code> method. There are other things that can also trigger cleaning and validation (accessing the errors attribute or calling full_clean() directly), but normally they won’t be needed. During Form validation the following actions are executed:</p><ol><li>Field.clean()<br /> It runs for each field of the form and invokes the following three methods:<ul><li><code class="highlighter-rouge">to_python()</code>: It coerces the raw input value to a correct python datatype depending on the form field type.</li><li><code class="highlighter-rouge">validate()</code>: It handles field-specific validation that is not suitable for a validator.</li><li><code class="highlighter-rouge">run_validators()</code>: It runs all of the field’s validators and aggregates all the errors into a single ValidationError. A validator is merely a callable object or function that takes a value and simply returns nothing if the value is valid or raises a ValidationError if not. You pass them to the form’s field in the form class definition.<blockquote><p><strong><em>Note</em></strong>: The Field.clean() method returns the clean data, which is then inserted into the <code class="highlighter-rouge">Form.cleaned_data</code> dictionary.</p></blockquote></li></ul></li><li><p>Field.clean_&lt;fieldname&gt;()<br /> It runs for each field of the form and does any cleaning that is specific to that particular field, unrelated to the type of field that it is. For example check if the value of a charfield is unique.</p></li><li>Form.clean()<br /> It runs after the individual field methods have run, so it has access to their errors too, available in <code class="highlighter-rouge">Form.errors</code> attribute. It can perform validation that requires access to multiple form fields. Errors raised by this method are accessed by the <code class="highlighter-rouge">Form.non_field_errors</code> attribute.</li></ol><h2 id="clearing-the-session-store">Clearing the session store</h2><p>In general you can use sessions in four ways:</p><ul><li>Using database-backed sessions (the session data is stored in the database)</li><li>Using cached sessions (the session data is stored in the cache but also in the database if you want)</li><li>Using file-based sessions (the session data is stored in a filesystem)</li><li>Using cookie-based sessions (the session data is stored in a cookie)</li></ul><p>As users create new sessions on your website, session data can accumulate in your session store. If you’re using the database backend, the django_session database table will grow. If you’re using the file backend, your temporary directory will contain an increasing number of files. To understand this problem, consider what happens with the database backend. When a user logs in, Django adds a row to the django_session database table. Django updates this row each time the session data changes. If the user logs out manually, Django deletes the row. But if the user does not log out, the row never gets deleted. A similar process happens with the file backend. Django does not provide automatic purging of expired sessions. Therefore, it’s your job to purge expired sessions on a regular basis. Django provides a clean-up management command for this purpose: <code class="highlighter-rouge">clearsessions</code>. It’s recommended to call this command on a regular basis, for example as a <strong>daily cron job</strong>.</p><blockquote><p><strong><em>Note</em></strong>: The cache backend (without persistence to the database) isn’t vulnerable to this problem, because caches automatically delete stale data. Neither is the cookie backend, because the session data is stored by the users’ browsers.</p></blockquote><h2 id="signals">Signals</h2><ul><li>Signals are not executed asynchronously. This means that the <code class="highlighter-rouge">post_save</code> signal will have to wait for the <code class="highlighter-rouge">pre_save</code> signal to finish.</li><li>Signals are part of Transactions. If there is an exception in the functions executed in the signal the transaction is rolled back. The signal is considered part of the transaction block.</li><li>The pre_save or post_save signals are a consequence of calling Model.save() method</li><li>Many of django signals are sent by various model methods like __init__() or save() that you can override in your own code. If you override these methods on your model, you must call the parent class’ methods for these signals to be sent.</li></ul><h2 id="querysetupdate-and-modelsave">Queryset.update() and Model.save()</h2><ul><li>The queryset.update() method does an update at the SQL level and thus, does not call any save() methods on your models nor does it emit the pre_save or post_save signals (which are a consequence of calling Model.save()).</li><li>Model DateFields with auto_now argument (used for tracking when was the latest update of a model) are not updated with queryset.update().</li><li>queryset.bulk_create() also doesn’t use the model’s save() method.</li><li>If you want to avoid these side effects of the queryset.update() then loop over the entries of the queryset and call  save() on each one of them.<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">elves</span> <span class="o">=</span> <span class="n">Elf</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
<span class="c1"># instead of doing this:
</span><span class="n">elves</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">weapon</span><span class="o">=</span><span class="s">'Elven Sword'</span><span class="p">)</span>
<span class="c1"># do this:
</span><span class="k">for</span> <span class="n">elf</span> <span class="ow">in</span> <span class="n">elves</span><span class="p">:</span>
  <span class="n">elf</span><span class="p">.</span><span class="n">weapon</span> <span class="o">=</span> <span class="s">'Elven Sword'</span>
  <span class="n">elf</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></table></code></div></div><blockquote><p><strong><em>Note</em></strong>: If your service uses concurrent application instances, then looping through entries, loading in memory and then saving might cause race conditions. To avoid them see <a href="/posts/django-tips/#avoiding-race-conditions-in-django">avoiding race conditions in django</a>.</p></blockquote></li></ul><h2 id="url-design">Url design</h2><p>When deciding whether to use the URL path or the query parameters for passing information, the following may help:</p><ol><li>use the URL path for uniquely identifying resources, for example /blog/post/15/ not /blog/posts/?id=15</li><li>use query parameters for changing the way the resource is displayed, for example /blog/django/2020/?sort_by=date&amp;direction=desc</li><li>to make human friendly URLs, avoid using ID numbers and use dates, categories or slugs, for example /blog/django/2020/09/30/django-urls/</li></ol><blockquote><p><strong><em>Note</em></strong>: The url query parameters are available in request.GET dictionary, for example: request.GET.get(“sort_by”).</p></blockquote><h2 id="number-of-entries-in-a-queryset">Number of entries in a queryset</h2><p>When you only want the number of entries in a queryset use the queryset’s count() method <code class="highlighter-rouge">queryset.count()</code> instead of the len function <code class="highlighter-rouge">len(queryset)</code>. The len function will evaluate the queryset, which means that it will fetch all the entries from the database and store them in memory, while the count method will just return the number of entries without returning the actual entries. Under the hood you have a <code class="highlighter-rouge">SELECT * FROM table</code> vs a <code class="highlighter-rouge">SELECT COUNT(*) FROM table</code> SQL query. If you intend to iterate over the entries though, you better use the len() function in order to avoid the double hit to the database (one for the count operation and one for the select all operation).</p><h2 id="callable-as-a-model-fields-default-value">Callable as a model field’s default value</h2><p>The default value of a field can be a callable object. In that case it will be called every time a new object is created.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">def</span> <span class="nf">get_deadline</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="p">.</span><span class="n">today</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Bill</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">deadline</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">get_deadline</span><span class="p">)</span>
</pre></table></code></div></div><blockquote><p><strong><em>Note</em></strong>: lambdas can’t be used for field options like default because they can’t be serialized by migrations.</p></blockquote><h2 id="extendable-views">Extendable views</h2><p>If you intent to build a django app for other developers, you would like to make it as customizable as possible. One way to customize a 3rd party django app is to override its views. You can make your app views easier to customize by adding some standard arguments to them, arguments like extra_context or upload_form and of course *args and **kwargs. For example with an <code class="highlighter-rouge">extra_context</code> argument you give others the possibility to easily update your view’s context. The modified context can then be rendered by slightly modifying the respective template in order to use it.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">original_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">next_override</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
                <span class="n">upload_form</span><span class="o">=</span><span class="n">UploadForm</span><span class="p">,</span> <span class="n">primary_form</span><span class="o">=</span><span class="n">PrimaryForm</span><span class="p">,</span> 
                <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="p">...</span>
    <span class="k">if</span> <span class="n">extra_context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">extra_context</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s">'the_context'</span><span class="p">:</span> <span class="n">the_context</span><span class="p">}</span>
    <span class="n">context</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">extra_context</span><span class="p">)</span>  <span class="c1"># update the context with the extra_context
</span>    <span class="n">template_name</span> <span class="o">=</span> <span class="n">settings</span><span class="p">.</span><span class="n">MYAPP_TEMPLATE</span> <span class="ow">or</span> <span class="s">'myapp/my_template.html'</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">template_name</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">my_override_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># do stuff before the original view is called
</span>    <span class="n">extra_context</span> <span class="o">=</span> <span class="p">{</span><span class="s">'new_context_item'</span><span class="p">:</span> <span class="n">item</span><span class="p">}</span>
    <span class="c1"># call the original view
</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">views</span><span class="p">.</span><span class="n">original_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_context</span><span class="o">=</span><span class="n">extra_context</span><span class="p">)</span>
    <span class="c1"># do stuff after the original view is called
</span>    <span class="k">return</span> <span class="n">response</span>
</pre></table></code></div></div><h2 id="miscellaneous">Miscellaneous</h2><ul><li>List of ids <br /> When you want a list of the ids or a list of any other field of a django model you can use the values_list() method.<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">MyModel</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">'id'</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">order_by</span><span class="p">(</span><span class="s">'id'</span><span class="p">)</span>
<span class="c1"># &lt;QuerySet [1, 2, 3, ...]&gt;
</span></pre></table></code></div></div></li><li>Evaluating querysets<br /> An (unevaluated) queryset doesn’t hold any data, it just represents a specific SQL query to the database. It only holds data when it is evaluated. A queryset is evaluated when:<ol><li>You iterate over it</li><li>You slice it</li><li>You pickle it</li><li>You call repr(), len(), list() on it</li><li>Testing it in a boolean context using it in an if, or, and statement or calling bool() on it.</li></ol></li><li>Django template comments vs html comments<br /> Django template comments are marked with <code class="highlighter-rouge">{# comment #}</code> while html native comments are <code class="highlighter-rouge">&lt;!-- comment --&gt;</code>. The difference is that django comments are not part of the rendered html, for example if you view page source in the browser you will not see them.</li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-development/'>Web-Development</a>, <a href='/categories/django/'>Django</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/django/" class="post-tag no-text-decoration" >django</a> <a href="/tags/tips/" class="post-tag no-text-decoration" >tips</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"> <!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Django Random Tips - Dimitris Georgoulas&url=https://dimyg.github.io/posts/django-tips/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Django Random Tips - Dimitris Georgoulas&u=https://dimyg.github.io/posts/django-tips/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Django Random Tips - Dimitris Georgoulas&url=https://dimyg.github.io/posts/django-tips/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/animations-with-d3-and-react/">Animations with d3 and react</a></li><li><a href="/posts/work-experience-overview/">Resume</a></li><li><a href="/posts/NYU-2021-DL-course-overview-and-notes/">NYU 2021 Deep Learning course overview and notes</a></li><li><a href="/posts/the-pharaoh-and-the-millionaire/">The pharaoh and the millionaire</a></li><li><a href="/posts/bitcoin-in-the-west/">Bitcoin in the west</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/work-experience/">work experience</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/economics/">economics</a> <a class="post-tag" href="/tags/zakanda/">zakanda</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/notes/">notes</a> <a class="post-tag" href="/tags/http/">http</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/javascript-essentials-some-tips/" class="btn btn-outline-primary"><p>Javascript Essentials, some tips</p></a> <a href="/posts/work-experience-overview/" class="btn btn-outline-primary"><p>Resume</p></a></div><!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/function-vs-class-based-views-in-django-rest/"><div class="card-body"> <span class="timeago small"> Apr 29, 2020 <i class="unloaded">2020-04-29T09:30:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Function vs Class based views in Django Rest Framework</h3><div class="text-muted small"><p>Customization or standardization Similarly to django, django rest framework offers you the choice of using class based views. As most things in life class based views come with their own pros and ...</p></div></div></a></div><div class="card"> <a href="/posts/understanding-http-caching/"><div class="card-body"> <span class="timeago small"> May 1, 2020 <i class="unloaded">2020-05-01T09:30:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Understanding HTTP Caching</h3><div class="text-muted small"><p>Server caches and Downstream caches HTTP caching mechanisms can be a bit confusing at first so let’s start clarifying them a bit. I would like to start by noting that in a typical client web serve...</p></div></div></a></div><div class="card"> <a href="/posts/zakanda_technical_overview/"><div class="card-body"> <span class="timeago small"> Jun 3, 2020 <i class="unloaded">2020-06-03T09:33:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Zakanda technical overview</h3><div class="text-muted small"><p>Introduction zakanda is my first entrepreneurial endeavor which… failed miserably. You can read the juicy details in my epic fail as a sports betting entrepreneur story. It was aspired to be a sp...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/DimiGeorgoulas">Dimitris Georgoulas</a></p></div><div class="footer-left"><p class="mb-0"> <span data-toggle="tooltip" data-placement="top" title="Bitcoin address">Bitcoin address: bc1q9wzun8urjcq52e6a4kxq8ha8des57hvk7808e6 </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/work-experience/">work experience</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/economics/">economics</a> <a class="post-tag" href="/tags/zakanda/">zakanda</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/notes/">notes</a> <a class="post-tag" href="/tags/http/">http</a></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-175153150-1', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dimyg.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
